<!-- main.html -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>主页面</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  
  <script src="main.js"></script>
  <script src="index.js"></script>

  <link rel="stylesheet" href="https://a.amap.com/jsapi_demos/static/demo-center/css/demo-center.css" />

  <link href="main.css" rel="stylesheet">
  <link href="map.css" rel="stylesheet">
  <link href="weather.css" rel="stylesheet">
  <link href="history.css" rel="stylesheet">
  <link href="setting.css" rel="stylesheet">
  <script src="qrcode.min.js"></script>

  
  

  <script> 
    window._AMapSecurityConfig = {
      securityJsCode: '6c569d1bdc12c850627523a56f4c3b3e',
    }
  </script>

</head>
<body>


  
  <!-- 地图所需代码 -->
  <div class="map-map" id='map-map' style="display: none;"></div>
  <div class="info map-map" style="display: none;">
      <h4 id='status'></h4><hr>
      <p id='result'></p><hr>
  </div>
  <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=b556f62b89a6b24871453d90532cbc16"></script>
  <script type="text/javascript">
      var map = new AMap.Map('map-map', {
          resizeEnable: true
      });
      AMap.plugin('AMap.Geolocation', function() {
        var geolocation = new AMap.Geolocation({
          enableHighAccuracy: true,//是否使用高精度定位，默认:true
          timeout: 10000,          //超过10秒后停止定位，默认：5s
          buttonPosition:'RB',    //定位按钮的停靠位置
          buttonOffset: new AMap.Pixel(10, 20),//定位按钮与设置的停靠位置的偏移量，默认：Pixel(10, 20)
          zoomToAccuracy: true,   //定位成功后是否自动调整地图视野到定位点
        });
        map.addControl(geolocation);
        geolocation.getCurrentPosition(function(status,result){
          if(status=='complete'){
            onComplete(result)
          }else{
            onError(result)
            }
          });
      });
      //解析定位结果
      function onComplete(data) {
        document.getElementById('status').innerHTML='定位成功'
        var str = [];
        str.push('定位结果：' + data.position);
        str.push('定位类别：' + data.location_type);


        // 更改地图定位
        // 获取 src 属性的值
        var src = $("#map-mapset").attr("src");
        // 使用正则表达式匹配经纬度
        var regex = /dest=(\d+\.\d+),(\d+\.\d+)/;
        // 使用 replace 方法替换经纬度为 data.position 的内容
        var newSrc = src.replace(regex, "dest=" + data.position);
        // 设置新的 src 属性的值
        $("#map-mapset").attr("src", newSrc);
        // alert(data.position);

        if(data.accuracy){
          str.push('精度：' + data.accuracy + ' 米');
        }//如为IP精确定位结果则没有精度信息
        str.push('是否经过偏移：' + (data.isConverted ? '是' : '否'));
        document.getElementById('result').innerHTML = str.join('<br>');
      }
      //解析定位错误信息
      function onError(data) {
          document.getElementById('status').innerHTML='定位失败'
          document.getElementById('result').innerHTML = '失败原因排查信息:'+data.message;
      }
  </script>
  
  
  <iframe style="display: none;" id="map-mapset" class="map-mapset" src="https://m.amap.com/navi/?dest=116.470098,39.992838&destName=默认城市&hideRouteIcon=1&key=b556f62b89a6b24871453d90532cbc16" frameborder="0"></iframe>

  <!-- 天气所需代码 -->
  <div class="weather-weatherset" id="weather-weatherset" style="display: none;">
    <div class="weatherset-top">
      <div class="weather-top-button" onclick="loadweathertoday()">
        <h1></h1>
        <img src="img/today.svg">
      </div>
      <div class="weather-top-button" onclick="loadweatherbing()">
        <h1></h1>
        <img src="img/bing.svg">
      </div>
    </div>
    <div class="weather-today" id="weather-today" style="display: none;">




    </div>    
    <div class="weather-bing" id="weather-bing" style="display: none;">    
      <div class="weather-QRcode">
        <h1>二维码生成器</h1>
        <p>请输入一个网址，点击生成按钮，即可在下方看到网址的二维码。</p>
        <input type="text" id="url" placeholder="www.hznu.edu.cn" style="width: 300px;">
        <button id="generate" onclick="loadQRcode()">生成3</button>
        <div class="qrcode" id="qrcode"></div>
      </div>      
      <div class="weather-bing-title" onclick="loadbing()">点击获得 Bing 每日一图</div>
      <div class="weather-bing-picture">
        <img id="Bingpicture" src="https://api.xygeng.cn/bing/view" alt="" style="display: none;">
      </div>
    </div>
  </div>


  <!-- 历史所需代码 -->

  
  <!-- 设置所需代码 -->


  <div class="setting-settingset" id="setting-settingset" style="display: block;">
    <div class="setting-person">
      <div class="setting-person-picture">
        <div class="setting-person-font">心晴头像</div>
        <img id="img" src="wea/wea (1).svg" alt="图片">
        <button id="next">换一个</button>
      </div>
    </div>    
  </div>
  <script>
    // 获取图片元素
    var img = document.getElementById("img");
    // 获取按钮元素
    var prev = document.getElementById("prev");
    var next = document.getElementById("next");
    // 定义一个变量，表示当前图片的索引
    var index = 1;
    // 定义一个函数，根据索引更新图片的src属性
    function updateImg() {
      img.src = "wea/wea (" + index + ").svg";
    }
    // 给下一张按钮添加点击事件
    next.onclick = function() {
      // 索引加一
      index++;
      // 如果索引大于28，就设置为1
      if (index > 28) {
        index = 1;
      }
      // 更新图片
      updateImg();
    }
  </script>






  <div class="container">
    <div class="md-md">
      <!-- 这里放置地图的内容 -->
      <div class="md-md-map" id="map" style="display: none;">
      </div>

      <!-- 这里放置天气的内容 -->
      <div class="md-md-weather" id="weather" style="display: none;">
            
        <div>weather</div>
      </div>

      <!-- 这里放置历史的内容 -->
      <div class="md-md-history" id="history" style="display: none;">
              
        <div>history</div>
      </div>

      <!-- 这里放置设置的内容 -->
      <div class="md-md-setting" id="setting" style="display: none;">
    
        <!-- <div>setting</div> -->
      </div>       
    </div>

    <!-- 下方四按钮 -->
    <div class="md-bt">
      <div class="md-bt-button md-bt-map" onclick="loadmap()">
        <h1></h1>
        <img src="img/map1.svg">
      </div>
      <div class="md-bt-button md-bt-weather" onclick="loadweather()">
        <h1></h1>
        <img src="img/weather1.svg">
      </div>
      <div class="md-bt-button md-bt-history" onclick="loadhistory()">
        <h1></h1>
        <img src="img/history1.svg">
      </div>
      <div class="md-bt-button md-bt-setting" onclick="loadsetting()">
        <h1></h1>
        <img src="img/setting1.svg">
      </div>
    </div>
  </div>
</body>
</html>
